compensation <-
structure(list(y1 = c(1, 1, 4, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 3, 1, 1, 4, 
1, 4, 2, 4, 2, 1, 1, 1, 2, 3, 1, 1, 2, 1, 4, 1, 1, 2, 1, 1, 2, 
2, 1, 3, 1, 2, 3, 2, 1, 3, 1, 3, 1, 3, 1, 3, 3, 1, 1, 1, 1, 1, 
1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 1, 4, 2, 1, 1, 1, 2, 1, 1, 2, 1, 
4, 1, 1, 1, 1, 3, 1, 2, 1, 2, 1, 1, 1, 2, 2, 1, 1, 2, 1), y2 = c(3, 
2, 1, 2, 3, 2, 4, 3, 4, 1, 4, 2, 3, 4, 2, 3, 3, 2, 2, 4, 3, 3, 
1, 3, 2, 2, 4, 2, 3, 2, 2, 2, 3, 1, 4, 3, 3, 3, 1, 4, 2, 3, 1, 
4, 4, 2, 3, 2, 3, 2, 3, 3, 4, 2, 1, 1, 4, 2, 4, 4, 2, 1, 2, 2, 
4, 4, 3, 4, 4, 2, 1, 2, 3, 2, 3, 4, 3, 4, 2, 3, 3, 4, 4, 2, 3, 
3, 2, 3, 3, 3, 4, 2, 4, 2, 3, 4, 3, 3, 3, 2, 2, 2, 2, 2, 1, 2, 
3, 4, 2, 3, 1, 1, 2, 3, 3, 2), y3 = c(4, 4, 2, 3, 4, 3, 2, 4, 
3, 3, 1, 4, 2, 2, 4, 2, 4, 3, 3, 3, 1, 2, 3, 1, 3, 3, 3, 3, 4, 
3, 1, 3, 2, 3, 2, 2, 1, 1, 3, 2, 4, 2, 4, 2, 2, 3, 1, 3, 1, 3, 
4, 4, 2, 3, 3, 4, 2, 1, 2, 1, 1, 4, 3, 1, 2, 1, 2, 1, 2, 1, 4, 
4, 4, 4, 4, 3, 4, 1, 3, 2, 4, 1, 3, 3, 2, 1, 3, 2, 1, 2, 2, 4, 
1, 3, 2, 1, 2, 1, 4, 3, 3, 3, 1, 4, 3, 3, 1, 2, 4, 2, 4, 3, 3, 
2, 1, 4), y4 = c(2, 3, 3, 4, 2, 4, 3, 2, 2, 4, 3, 3, 4, 3, 3, 
4, 2, 4, 4, 2, 4, 4, 4, 4, 4, 4, 2, 4, 2, 4, 4, 4, 4, 2, 3, 1, 
4, 2, 4, 3, 3, 4, 3, 1, 3, 4, 4, 4, 2, 4, 2, 1, 3, 4, 4, 3, 3, 
4, 3, 3, 4, 3, 4, 4, 3, 2, 4, 2, 3, 4, 2, 3, 2, 3, 2, 2, 2, 3, 
4, 4, 1, 3, 2, 4, 4, 4, 4, 1, 4, 4, 3, 3, 3, 4, 4, 3, 4, 2, 2, 
4, 4, 4, 4, 3, 4, 4, 4, 3, 3, 4, 3, 4, 4, 4, 4, 3), hi = c(4.2, 
6.2, 4.8, 5.2, 6, 6, 6.6, 3.8, 6.6, 5.2, 4.2, 6.4, 6.4, 5.6, 
4.6, 5.8, 5, 5.2, 5.8, 5.8, 3.6, 6.4, 6, 6.2, 4.8, 5.2, 5.6, 
5, 6.8, 5.6, 5.4, 5.2, 5.2, 5.6, 5.8, 5, 4.2, 5, 5.4, 4.8, 4, 
6.6, 4.4, 6.4, 4.6, 6, 6.4, 6.8, 5.4, 6.2, 6.2, 5.4, 5.6, 5.2, 
4.4, 6, 4, 5.8, 5, 4.8, 5, 5.2, 4.6, 5.6, 5.8, 5.2, 5.6, 5.6, 
5.4, 5.6, 3.2, 5.2, 5.2, 6.4, 6.2, 6.6, 6.2, 6, 4.6, 5, 5, 5.8, 
5.4, 6.6, 5.2, 4.6, 6.2, 5.6, 6, 5.8, 7, 6.4, 4.4, 6.4, 5.6, 
3.6, 6, 5.8, 7, 6.2, 5.4, 5, 4, 2.4, 4, 6.2, 5.2, 6.6, 5.4, 6.6, 
6.2, 5.8, 5.2, 5.6, 6, 4.8), hc = c(4.57, 5.29, 4.57, 4.71, 6.57, 
3.86, 5, 3.71, 4, 5.14, 3.43, 4.29, 6.43, 4.71, 3.86, 3, 4.29, 
4.71, 5.14, 4.43, 3.43, 4.43, 5, 4.43, 4.29, 4.29, 4.86, 2.71, 
5.86, 5.43, 5.14, 3.29, 5.29, 4, 4, 4.71, 5.57, 5.29, 5.71, 5.57, 
6, 6, 3.86, 5.43, 3.86, 5.57, 6.14, 5.43, 4.71, 4.71, 6.14, 4.43, 
3.14, 4.43, 2.14, 4, 4.29, 5.43, 3.57, 4.29, 2.14, 4.14, 3.29, 
3.29, 4.57, 5.14, 4.71, 3.29, 4.14, 4.29, 4.14, 6.43, 4.86, 4.14, 
3.29, 4.14, 5.43, 4, 4.57, 6, 2.14, 4, 4.71, 5.86, 6, 5.14, 5.14, 
5.29, 4.43, 4.43, 6.71, 6.43, 4.14, 4.57, 5.71, 5.43, 5.71, 4.43, 
5.43, 3.43, 3.86, 4.29, 4.71, 2.71, 5.14, 5.29, 5.86, 6.57, 4.29, 
5.29, 3.86, 4.14, 4.43, 5.43, 4.29, 5), vi = c(5, 5.86, 6, 5.43, 
5.57, 5.71, 5.71, 5.43, 5.86, 6, 4.29, 6.14, 5.43, 6.14, 6, 5.71, 
6.29, 6.14, 5.29, 5.14, 5.43, 5.71, 5.86, 5.43, 5.29, 5.71, 4.43, 
6.14, 6.14, 6.14, 4.71, 5.43, 5.86, 5.43, 5.14, 4.86, 5.43, 5.29, 
5.57, 5, 6, 6.14, 5.43, 5.29, 4.57, 5, 4.57, 5.86, 5.14, 5.43, 
4.29, 5.71, 5.86, 6.29, 6, 6.43, 5, 5.71, 5.57, 6.14, 5.57, 5.14, 
4.86, 5, 5.57, 4.57, 5.29, 5.86, 5.86, 5, 5, 4, 5.29, 6.86, 5.86, 
4.43, 6, 5.86, 4.86, 3.86, 5.57, 5.57, 4.29, 6.29, 5, 6.43, 6.57, 
5.43, 4.71, 5.71, 4.14, 5.71, 4.43, 5.43, 5.71, 5.71, 4.43, 5.86, 
5.29, 4.86, 5.43, 4.86, 5.86, 2, 5.14, 5.57, 5.29, 5.71, 4.57, 
6.86, 5.14, 6.43, 5.29, 6.43, 5.29, 5.71), vc = c(6, 5.6, 6.2, 
4.4, 6.2, 5.6, 4, 4.8, 5.8, 5.2, 4, 5.2, 4.8, 5.2, 5.8, 6.2, 
5.4, 6.2, 5.8, 4, 5.6, 5.4, 6, 6.6, 4.8, 5.4, 5.4, 5.8, 6.4, 
6.6, 4.8, 5.2, 4.4, 5.8, 4.8, 5.8, 4.4, 5.2, 6.2, 5.4, 6.6, 4.8, 
5.2, 6.2, 4.4, 5.2, 6, 5, 5.6, 6, 3.8, 5.8, 5.8, 6.6, 6.6, 5.4, 
5, 5.6, 5.8, 6.4, 4.2, 5.4, 4.8, 5.2, 5.4, 3.6, 5.8, 5.6, 5.2, 
5.4, 4.8, 4.8, 5.8, 6.2, 4.8, 3.4, 5.6, 5.8, 4.8, 3.6, 5.6, 5.2, 
5.4, 5.6, 3.8, 5.8, 6.6, 5.4, 4.8, 4.8, 5.2, 5.6, 5.2, 6.2, 5.4, 
5.8, 5.4, 5, 4.6, 4.4, 3.8, 4, 5, 2.4, 6, 5.2, 5.6, 6.2, 5.2, 
6.2, 5.8, 6.6, 6.2, 5, 5.2, 5.8)), .Names = c("y1", "y2", "y3", 
"y4", "hi", "hc", "vi", "vc"), class = "data.frame", row.names = c(NA, 
-116L))
resume <-
structure(list(mc.rank = c(1L, 1L, 1L, 3L, 3L, 2L, 1L, 2L, 1L, 
3L, 3L, 2L, 1L, 1L, 2L, 3L, 2L, 1L, 1L, 1L, 2L, 3L, 1L, 1L, 1L, 
1L, 3L, 2L, 1L, 1L, 1L, 1L, 2L, 3L, 1L, 1L, 1L, 2L, 3L, 3L, 1L, 
1L, 1L, 1L, 2L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 
1L, 1L, 2L, 3L, 3L, 1L, 2L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 3L, 1L
), as.rank = c(3L, 2L, 2L, 2L, 2L, 3L, 3L, 1L, 2L, 2L, 1L, 1L, 
3L, 2L, 3L, 1L, 3L, 3L, 3L, 2L, 3L, 1L, 3L, 3L, 2L, 2L, 1L, 1L, 
3L, 3L, 2L, 2L, 3L, 1L, 3L, 3L, 2L, 1L, 2L, 2L, 3L, 2L, 2L, 2L, 
3L, 1L, 3L, 2L, 2L, 2L, 3L, 3L, 3L, 2L, 2L, 2L, 1L, 3L, 3L, 1L, 
1L, 2L, 3L, 3L, 1L, 1L, 1L, 1L, 3L, 3L, 2L, 1L, 3L), sw.rank = c(2L, 
3L, 3L, 1L, 1L, 1L, 2L, 3L, 3L, 1L, 2L, 3L, 2L, 3L, 1L, 2L, 1L, 
2L, 2L, 3L, 1L, 2L, 2L, 2L, 3L, 3L, 2L, 3L, 2L, 2L, 3L, 3L, 1L, 
2L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 3L, 3L, 3L, 1L, 2L, 2L, 3L, 3L, 
3L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 2L, 1L, 2L, 1L, 3L, 
3L, 2L, 2L, 2L, 2L, 3L, 2L, 2L), dates.mc = c(1, 1, 0, 0, 0, 
0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 
0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 
1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 
0, 1, 1, 0, 0), degree.mc = c(0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 
0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 
1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 
0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0), 
    dates.sw = c(0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 
    0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 
    1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 
    0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 
    1), degree.sw = c(0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 
    1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 
    0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 
    0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 
    1, 0, 0), dates.as = c(0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 
    0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 
    1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 
    1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 
    0, 0, 0, 0), degree.as = c(1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 
    0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 
    1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 
    0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 
    0, 1, 1, 0, 0, 1)), .Names = c("mc.rank", "as.rank", "sw.rank", 
"dates.mc", "degree.mc", "dates.sw", "degree.sw", "dates.as", 
"degree.as"), row.names = c(NA, -73L), class = "data.frame")
makeinits <-
function (y) 
{
    n <- nrow(y)
    m <- ncol(y)
    z <- matrix(NA, n, m)
    for (i in 1:n) { 
        z[i,] <- sort(rnorm(m))[rank(-y[i,])]
        z[i,] <- z[i,] - z[i,m]
    }
    z
}
